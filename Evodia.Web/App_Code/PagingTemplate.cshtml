@using Evodia.Core.Utility

@helper RenderPaging(Paging paging, int currentId, string request = "")
{
    var umbracoHelper = new Umbraco.Web.UmbracoHelper(Umbraco.Web.UmbracoContext.Current);
    var queryString = string.Empty;

    if (!string.IsNullOrWhiteSpace(request))
    {
        foreach (var key in HttpUtility.ParseQueryString(request))
        {
            if (key != null && (string) key != "page")
            {
                queryString = queryString + "&" + key + "=" + Request.QueryString[(string) key];
            }
        }
    }
    else
    {
        foreach (var key in Request.QueryString)
        {
            if (key != null && (string)key != "page")
            {
                queryString = queryString + "&" + key + "=" + Request.QueryString[(string)key];
            }
        }
    }



    if (paging.CurrentPage > 1)
    {
            <a href="@umbracoHelper.TypedContent(currentId).Url">First</a>
            <a href="@umbracoHelper.TypedContent(currentId).Url?page=@(paging.CurrentPage - 1)@queryString" class="c-pagination__link c-pagination__link--prev" rel="prev">
                <i class="ico-arrow-left-compact" role="presentation"></i> <span class="u-hide-text">Previous</span>
            </a>
    }

    for (var page = paging.StartPage; page <= paging.EndPage; page++)
    {
            <a href="@umbracoHelper.TypedContent(currentId).Url?page=@page@queryString" class='c-pagination__link c-pagination__link--index @( paging.CurrentPage == page ? "is-active" : "" )'>
                @page
            </a>
    }

    if (paging.CurrentPage < paging.TotalPages)
    {
            <a href="@umbracoHelper.TypedContent(currentId).Url?page=@(paging.CurrentPage + 1)@queryString" class="c-pagination__link c-pagination__link--next" rel="next">
                <span class="u-hide-text">Next</span> <i class="ico-arrow-right-compact" role="presentation"></i>
            </a>
            <a href="@umbracoHelper.TypedContent(currentId).Url?page=@(paging.TotalPages)@queryString">Last</a>
    }
}